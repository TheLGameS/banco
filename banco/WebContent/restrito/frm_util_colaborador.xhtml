<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	>
     
    <h:head>
		<h:outputStylesheet library="css" name="estiloDesktop.css"/>
    </h:head>
     
    <h:body>
       <h:form id="cadColaborador"  >
			<p:panel id="pnlpar" style="margin-bottom:20px" header="Cadastro de Colaboradores">
				<p:messages id="messageGe"   autoUpdate="true"  closable="true" showIcon="false" />

				<p:toolbar>
					<f:facet name="left">
						<p:commandButton value="Inclui" icon="ui-icon-plusthick" 	action="#{colaboradorBean.novo}" oncomplete="PF('dlgIncluir').show();" update=":dlgIncluir" >
						<f:setPropertyActionListener value="#{false}" target="#{colaboradorBean.alteraRegistro}"  /> 
						</p:commandButton>
					</f:facet>
				</p:toolbar>

				<p:dataTable value="#{colaboradorBean.lista}"
					resizableColumns="true" draggableColumns="true" id="colaborador"
					var="colaborador" rows="10" paginator="true"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					currentPageReportTemplate="Página {currentPage} de {totalPages}"
					rowsPerPageTemplate="10,15,20,50" paginatorPosition="bottom">

					<p:column headerText="Código" width="10">
						<h:outputText value="#{colaborador.colCod}" />
					</p:column>

					<p:column headerText="Descrição" filterBy="#{colaborador.colRaz}"
						filterMatchMode="contains" width="300" id="filtro">
						<h:outputText value="#{colaborador.colRaz}" />
					</p:column>
					
					<p:column headerText="Ações" width="95" id="acoes">
						<p:commandButton icon="ui-icon-circle-check" actionListener="#{colaboradorBean.colaboradorSelecionadoDialog(colaborador)}" 
										style="float:right" title="Seleciona"  >							
						</p:commandButton>	
						
						<p:commandButton action="#{colaboradorBean.obterPorId()}"
							icon="ui-icon-search" style="float:right" title="Busca"  update=":dlgIncluir" resetValues="true"
							oncomplete="PF('dlgIncluir').show();">
							<f:setPropertyActionListener value="#{colaborador}" target="#{colaboradorBean.colaborador}"  />
							<f:setPropertyActionListener value="#{true}" target="#{colaboradorBean.podeAlterar}"  />
							<f:setPropertyActionListener value="#{false}" target="#{colaboradorBean.alteraRegistro}"  /> 
						</p:commandButton>
						
						<p:commandButton  update=":confirmacao,:cadColaborador" icon="ui-icon-trash" title="Exclui" style="float:right" 
							onclick="PF('confirmation').show();"  action="#{colaboradorBean.excluir()}"  id="tsc">
							<p:confirm header="Responda..." icon="ui-icon-blank" message="Confirma a exclusão ?"  />
							<f:setPropertyActionListener  value="#{colaborador}" target="#{colaboradorBean.colaborador}"  />
						</p:commandButton>

						<p:commandButton action="#{colaboradorBean.obterPorId()}"  update=":dlgIncluir" resetValues="true"
							icon="ui-icon-pencil" style="float:right" title="Altera" oncomplete="PF('dlgIncluir').show();">
							<f:setPropertyActionListener value="#{colaborador}" target="#{colaboradorBean.colaborador}"  />
							<f:setPropertyActionListener value="#{true}" target="#{colaboradorBean.alteraRegistro}"  />
						</p:commandButton>
					</p:column>

				</p:dataTable>
							
				
		</p:panel>
	
		</h:form>

			
				
		<p:dialog id="dlgIncluir" widgetVar="dlgIncluir" resizable="false"
			modal="true" draggable="false" header="Cadastro de Colaboradores"
		 location="center" closable="true"
			closeOnEscape="true" height="520" width="660"  >
			<h:form  id="dlg" >
				<p:messages id="messages"  autoUpdate="true"  closable="true" showIcon="false"   />
				<p:fieldset >
					<p:panelGrid  styleClass="semBorda"  columns="2" >
						
						<p:outputLabel value="Código" for="codigo"/>				
						<p:panelGrid  columns="8">
							<p:inputText id="codigo" value="#{colaboradorBean.colaborador.colCod}" 
								maxlength="7" 
								required="true"
								requiredMessage="Campo Código é obrigatório."
								disabled="#{colaboradorBean.alteraRegistro || colaboradorBean.podeAlterar}"  
								style="padding-right: 5px; float: right; width:45px " />
							<p:selectOneMenu id="pcbTipo" value="#{colaboradorBean.colaborador.colTip}"  
								style="width:60px" effect="drop" disabled="#{colaboradorBean.podeAlterar  || colaboradorBean.alteraRegistro }">
								<f:selectItem itemLabel="CNPJ" itemValue="CNPJ" />
								<f:selectItem itemLabel="CPF"  itemValue="CPF" />
								<f:selectItem itemLabel="CEI"  itemValue="CEI" />
								<f:selectItem itemLabel="EX"   itemValue="EX" />
							</p:selectOneMenu>
							<p:inputText id="documento" value="#{colaboradorBean.colaborador.colInf}" style="width:90px"
								 maxlength="14" disabled="#{colaboradorBean.podeAlterar  || colaboradorBean.alteraRegistro }"/>
							<p:outputLabel value="Apelido" for="apelido"/>
							<p:inputText id="apelido" value="#{colaboradorBean.colaborador.colApe}" style="width:105px" maxlength="15" disabled="#{colaboradorBean.podeAlterar}"/>
						</p:panelGrid>
						
						<p:outputLabel value="Razão Social" for="polRazaoSocial" />
						<p:panelGrid   columns="1">
							<p:inputText id="polRazaoSocial" value="#{colaboradorBean.colaborador.colRaz}"
								required="true"
								requiredMessage="Campo Razão Social é Obrigatório" 
								style="width:400px" maxlength="50" disabled="#{colaboradorBean.podeAlterar}" />
						</p:panelGrid>
						
						<p:outputLabel value="Nome Fantasia" for="polNmFantasia" />
						<p:panelGrid   columns="1">
							<p:inputText id="polNmFantasia" value="#{colaboradorBean.colaborador.colNmf}" style="width:400px" maxlength="50" disabled="#{colaboradorBean.podeAlterar}" />
						</p:panelGrid>
						
						<p:outputLabel value="CEP" for="cep"/>
						<p:panelGrid   columns="2"  id="panelCep" >
							<p:inputMask id="cep" value="#{colaboradorBean.colaborador.colCep}" maxlength="9" style="width:60px" mask="99999-999" required="true" requiredMessage="Campo CEP é Obrigatório" disabled="#{colaboradorBean.podeAlterar}" />
							<p:commandButton value="Consulta CEP" actionListener="#{colaboradorBean.encontraCEP()}" update=":dlg:panelCep" disabled="#{colaboradorBean.podeAlterar}" >
							</p:commandButton>
						</p:panelGrid>
						
						
						<p:outputLabel for="uf" value="Município" />
						<p:panelGrid   columns="3"  id="panelMunicipio" >
							<p:inputText id="uf" maxlength="6" size="3" value="#{colaboradorBean.municipioExibidoDialog.munCod}" required="true" disabled="#{colaboradorBean.podeAlterar}"   onkeydown="if (event.keyCode == 32) {PF('dlgEstado').show(); return false; }" requiredMessage="Campo Município é Obrigatório"/>
							<p:inputText id="ufnome" value="#{colaboradorBean.municipioExibidoDialog.munNom}"    disabled="#{colaboradorBean.podeAlterar   }"/>
							<p:commandButton value="..."    id="botaoConsulta"     actionListener="#{colaboradorBean.escolhaDeMunicipio()}" immediate="true"  disabled="#{colaboradorBean.podeAlterar}" >
								<p:ajax event="dialogReturn" listener="#{colaboradorBean.retornoMunicipioSelecionado}" update=":dlg:panelMunicipio"     />
							</p:commandButton>
						</p:panelGrid>
						
						
		
						<p:outputLabel value="Endereço" for="end" />
						<p:panelGrid  columns="3" id="ender">
							<p:inputText   id="end" value="#{colaboradorBean.colaborador.colEnd}"  maxlength="40" style="width:273px" required="true" requiredMessage="Campo Endereço é Obrigatório" disabled="#{colaboradorBean.podeAlterar}"/>
							<p:outputLabel value="Número" for="numero" />
							<p:inputText   id="numero" value="#{colaboradorBean.colaborador.colNro}"  maxlength="7" style="width:50px" disabled="#{colaboradorBean.podeAlterar}"/>
						</p:panelGrid>
		
						<p:outputLabel value="Complemento" for="comp" id="retornoCep"/>
						<p:panelGrid columns="3" >
							<p:inputText id="comp" value="#{colaboradorBean.colaborador.colCpl}"  maxlength="20" style="width:167px" disabled="#{colaboradorBean.podeAlterar}"/>
							<p:outputLabel value="Bairro" for="bairro" />
							<p:inputText id="bairro" value="#{colaboradorBean.colaborador.colBai}"  maxlength="20" style="width:167px" disabled="#{colaboradorBean.podeAlterar}"/>
						</p:panelGrid>
						
						<p:outputLabel value="Contr.ICMS" for="pcbIcm"   />
						<p:panelGrid columns="4"  >
							<p:selectOneMenu id="pcbIcm" value="#{colaboradorBean.colaborador.colIcm}"   
								style="width:60px" effect="drop" disabled="#{colaboradorBean.podeAlterar}">
								<f:selectItem itemLabel="Sim" itemValue="S" />
								<f:selectItem itemLabel="Não" itemValue="N" />
							</p:selectOneMenu>
							<p:outputLabel value="Simples Nacional" for="pcbSimplesNacional"   />
							<p:selectOneMenu id="pcbSimplesNacional" value="#{colaboradorBean.colaborador.colOsf}"  
								style="width:120px" effect="drop" disabled="#{colaboradorBean.podeAlterar   }">
								<f:selectItem itemLabel="Não Optante" itemValue="N" />
								<f:selectItem itemLabel="Optante ME"  itemValue="M" />
								<f:selectItem itemLabel="Optante EPP" itemValue="E" />
							</p:selectOneMenu>
						</p:panelGrid>	
						
						<p:outputLabel id="vazio"/>
						<p:panelGrid columns="7"> 
							<p:outputLabel id="vazio1"/>
							<p:outputLabel id="vazio2"/>
							<h:inputHidden value="#{colaboradorBean.colaborador.colCod}" />
							<h:inputHidden value="#{colaboradorBean.colaborador.colTip}" />
							<h:inputHidden value="#{colaboradorBean.colaborador.colInf}" />
							<p:commandButton value="Grava" id="btnGrava" action="#{colaboradorBean.salvar}"  update=":cadColaborador,:dlg"  rendered="#{!colaboradorBean.podeAlterar}" icon="ui-icon-check" oncomplete="if (args &amp;&amp; !args.validationFailed) PF('dlgIncluir').hide();"   />
							<p:commandButton value="Cancela" id="btnCancela" onclick="PF('dlgIncluir').hide();" icon="ui-icon-closethick"  immediate="true" ajax="true" update=":dlgIncluir"/>
						</p:panelGrid>	
						
					</p:panelGrid>
				</p:fieldset>
			</h:form>
		</p:dialog>
		
		<h:form id="confirmacao" >
		    <p:confirmDialog    severity="alert" widgetVar="confirmation"  global="true" closeOnEscape="true" closable="false" >
    	    	<center>
    	    		<p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" actionListener="#{colaboradorBean.excluir}" process="@form" update=":cadColaborador, :messageGe"   > 
    					<f:setPropertyActionListener  value="#{colaborador}" target="#{colaboradorBean.colaborador}"  />
    				</p:commandButton>
		        	<p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>
		        </center>
    		</p:confirmDialog>
		</h:form>
    </h:body>
     
</html>